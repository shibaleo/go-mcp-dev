# MCPサーバー スコープ外機能

本ドキュメントは、MCPサーバーが**担当しない機能**を定義する。
これらはLLMクライアント、UI、運用方針、または設計思想に依存する。

---

## スコープ外カテゴリ一覧

| カテゴリID | カテゴリ名 | 概要 |
|-----------|-----------|------|
| OFS-001 | 通知・UX設計 | 通知制御・UI表示・ログ表示 |
| OFS-002 | LLM振る舞い制御 | LLMの判断・出力制御 |
| OFS-003 | タスク分解・構造化 | 自然言語からのタスク分解 |
| OFS-004 | 開発方針・設計思想 | 実装方針・設計原則 |
| OFS-005 | 運用・責任境界 | 運用方針・責任分担 |
| OFS-006 | 主観的成果 | ユーザー体感・便利さの実感 |
| OFS-007 | ユーザー・組織 | マルチテナント・エンタープライズ対応 |
| OFS-008 | 非決定論的処理 | LLMが必要な処理 |
| OFS-009 | プロトコル・インフラ | MCP仕様拡張・特定ベンダー依存 |

---

## OFS-001: 通知・UX設計

### 対応する要件（LLMベンダ依存）

| REQ-ID | 項目 | 分類 |
|--------|------|------|
| REQ-064 | タスク失敗時のみ通知される | LLMベンダ依存 |
| REQ-065 | ユーザーの操作や承認は最小限 | LLMベンダ依存 |
| REQ-066 | 異常や偏りのみ通知 | LLMベンダ依存 |
| REQ-071 | 成功時の通知は最小限に抑えられる | LLMベンダ依存 |
| REQ-072 | 細かいログはデフォルト非表示 | LLMベンダ依存 |
| REQ-075 | 学習時間を侵食しないUXである | LLMベンダ依存 |
| REQ-076 | 不要な確認往復が発生しないこと | LLMベンダ依存 |

### 理由

- 通知制御はクライアント/UI側の実装に依存
- ログ表示・非表示はUI設計に依存
- UX全体はクライアント側の責任

### 代替アプローチ

- 構造化レスポンス（成功/失敗/警告を明確に区別）
- ログレベルをレスポンスに含める
- エラー情報の詳細返却

---

## OFS-002: LLM振る舞い制御

### 対応する要件（LLMベンダ依存）

| REQ-ID | 項目 | 分類 |
|--------|------|------|
| REQ-067 | 税務・業務判断を自動で確定しない | LLMベンダ依存 |
| REQ-068 | LLMは候補・下書き・整理までに留まる | LLMベンダ依存 |
| REQ-087 | AIは伴走者として振る舞うこと | LLMベンダ依存 |
| REQ-088 | 抽象的・最終的な判断を強制しないこと | LLMベンダ依存 |
| REQ-089 | 選択肢と理由を提示すること | LLMベンダ依存 |

### 理由

- LLMの振る舞いはプロンプト設計・システムプロンプトに依存
- 判断制御はLLMクライアント側の設定に依存
- 出力形式はクライアント側で制御

### 代替アプローチ

- ツール説明文で意図を明確化
- 危険操作フラグをレスポンスに含める
- 推奨プロンプト設計をドキュメントで提供

---

## OFS-003: タスク分解・構造化

### 対応する要件（LLMベンダ依存）

| REQ-ID | 項目 | 分類 |
|--------|------|------|
| REQ-069 | 自然言語の業務説明からタスクを分解できる | LLMベンダ依存 |
| REQ-070 | 依存関係・並列可能性を明示できる | LLMベンダ依存 |

### 理由

- タスク分解はLLMの推論能力に依存
- 依存関係分析は非決定論的処理

### 代替アプローチ

- タスク構造出力ツール（LLMが生成した構造を保存・可視化）
- 計画用ツールと実行用ツールの分離

---

## OFS-004: 開発方針・設計思想

### 対応する要件（LLMベンダ依存）

| REQ-ID | 項目 | 分類 |
|--------|------|------|
| REQ-077 | 最小構成で即座に動作確認できること | LLMベンダ依存 |
| REQ-078 | 初期段階で完璧な設計を要求しないこと | LLMベンダ依存 |
| REQ-079 | 後から修正・差し替えが容易な構造であること | LLMベンダ依存 |
| REQ-080 | 実装は「動くこと」を最優先に進められること | LLMベンダ依存 |
| REQ-081 | テストコードは実装後に自動生成できること | LLMベンダ依存 |
| REQ-082 | セキュリティチェックは別工程で実施できること | LLMベンダ依存 |
| REQ-083 | テスト結果とセキュリティ結果が明確に区別されること | LLMベンダ依存 |
| REQ-084 | ローカル・個人環境での破損は許容されること | LLMベンダ依存 |
| REQ-085 | 一時的な停止や不安定さは許容されること | LLMベンダ依存 |
| REQ-086 | 外部公開時のリスクポイントが明示されること | LLMベンダ依存 |

### 理由

- 開発方針はMCPサーバー自体の設計思想であり、機能ではない
- テスト・セキュリティは開発プロセス・ツールチェーンに依存
- リスク許容はユーザーの運用方針に依存

### 対応方針

- MCPサーバー自体の設計原則として採用
- ドキュメント・READMEで設計思想を明示
- モジュラー設計で後から修正・差し替え容易な構造を実現

---

## OFS-005: 運用・責任境界

### 対応する要件（LLMベンダ依存）

| REQ-ID | 項目 | 分類 |
|--------|------|------|
| REQ-073 | 業務フローや組織を変えることを前提としない | LLMベンダ依存 |
| REQ-074 | 自動化の責任はユーザーが負う | LLMベンダ依存 |

### 理由

- 運用方針はユーザーの利用方法に依存
- 責任分担は利用規約・ドキュメントで明示

### 対応方針

- 利用ガイドで推奨運用方法を提示
- 免責事項をドキュメントに記載
- 個人利用前提の設計を維持

---

## OFS-006: 主観的成果

### 対応する要件（LLMベンダ依存）

| REQ-ID | 項目 | 分類 |
|--------|------|------|
| REQ-090 | 使用者の思考がすっきりすること | LLMベンダ依存 |
| REQ-091 | 「便利になった」と実感できること | LLMベンダ依存 |
| REQ-092 | 同じ課題を持つ人にも価値が伝わること | LLMベンダ依存 |

### 理由

- 主観的体験はユーザーの感覚であり、機能で直接実現不可
- 価値伝達はドキュメント・コミュニケーションに依存

### 対応方針

- 高品質なツール実装で間接的に貢献
- ユーザーフィードバックを収集し改善
- ドキュメント整備で価値を明確化

---

## OFS-007: ユーザー・組織

### スコープ外項目

| 項目 | 理由 |
|------|------|
| マルチテナント対応 | シングルテナント・シングルユーザー設計 |
| 他人のOAuthトークン管理 | 自分専用のセルフホストサーバー |
| エンタープライズIdP | 個人向けツール |
| 組織ガバナンス | テナントは個人 |
| 平均的ユーザーへの最適化 | 技術に精通したユーザー向け |

---

## OFS-008: 非決定論的処理

### スコープ外項目

| 項目 | 理由 |
|------|------|
| データ永続化（ベクトル化） | 呼び出し結果を保存・ベクトル化しない |
| ツール選択判断 | どのツールを呼ぶかはLLM側の責任 |
| 要約・統合・再構成 | LLMが必要な処理 |
| バックエンドLLM | 推論処理はユーザーLLMに委ねる |
| 条件分岐・ループ | 複雑な制御フローはLLMとの対話で解決 |
| 動的なタスク生成 | LLMの推論に依存 |

---

## OFS-009: プロトコル・インフラ

### スコープ外項目

| 項目 | 理由 |
|------|------|
| MCP仕様の拡張 | MCPを利用する設計パターン |
| 独自プロトコル | JSON-RPC 2.0 over SSE（MCP準拠） |
| 特定ベンダーへの認証権限集中 | ポータビリティ確保 |
| 有料インフラ前提 | 無料枠で運用可能な構成を推奨 |

---

## 集計

### 受け入れ基準ベースの集計

| カテゴリ | 項目数 |
|---------|--------|
| OFS-001 通知・UX設計 | 7 |
| OFS-002 LLM振る舞い制御 | 5 |
| OFS-003 タスク分解・構造化 | 2 |
| OFS-004 開発方針・設計思想 | 10 |
| OFS-005 運用・責任境界 | 2 |
| OFS-006 主観的成果 | 3 |
| **受け入れ基準ベース合計** | **29** |

※ OFS-007〜OFS-009は受け入れ基準に直接対応しない設計上のスコープ外項目

---

## スコープ外の判断基準

1. **非決定論的処理**: LLMが必要な処理はMCPサーバー側で行わない
2. **マルチユーザー対応**: 自分以外のユーザーを想定しない
3. **複雑な制御フロー**: LLMとの対話で解決すべき問題
4. **プロトコル拡張**: 既存のMCP仕様を変更・拡張しない
5. **クライアント依存**: UI・通知などクライアント側の責任

※ 並列・バックグラウンド実行はMCPサーバーで実現可能（LLMはタスク指定・スケジューリングのみ）
※ コンテキスト管理はMCPサーバーで部分対応可能（initialize時のツール制御、ユーザー別フィルター）

---

## 関連ドキュメント

- [機能要件](req-fnr.md)
- [非機能要件](req-nfr.md)
- [要件一覧](req-list.md)
- [ペルソナサマリー](user-analysis-summary.md)
